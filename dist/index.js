var handle;(()=>{"use strict";var e={d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Album:()=>l,Music:()=>n,albumFunc:()=>r});class a extends HTMLElement{connectedCallback(){let e=this.getElementsByTagName("card-album-title"),t=this.getElementsByTagName("card-album-text"),a=this.getAttribute("image-src"),l=this.getAttribute("album-idx"),n=document.createElement("div"),r=document.createElement("img"),i=document.createElement("h5"),m=document.createElement("p");for(this.classList.add("col-6"),n.classList.add("card","card-border-none","mb-3"),n.setAttribute("onclick",`render('/page/album/${l}')`),r.classList.add("card-img-square"),i.classList.add("card-title","mt-2"),m.classList.add("card-text"),r.setAttribute("src",a),r.setAttribute("onerror","this.src='/static/image/album.jpg'"),i.innerText=e[0].innerText,m.innerText=t[0].innerText;this.firstChild;)this.removeChild(this.firstChild);n.appendChild(r),n.appendChild(i),n.appendChild(m),this.appendChild(n)}}class l{constructor(){}async create(e){return(await fetch("/api/album",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`album_title=${e.album_title}&album_text=${e.album_text}&album_image=${e.album_image}`})).json()}async read(e){let t="all"==e.album_idx?"":e.album_idx;return(await fetch(`/api/album/${t}`,{method:"GET"})).json()}async delete(e){return(await fetch(`/api/album/${e.album_idx}`,{method:"DELETE"})).json()}}class n{constructor(){}async upload(e){return(await fetch("/api/music",{method:"POST",body:e})).json()}async get(e){return(await fetch(`/api/music/${e}`,{method:"GET"})).json()}}const r={addAlbum:async function(){let e=new handle.Album,t={album_title:document.querySelector("#form_album_title").value,album_text:document.querySelector("#form_album_text").value,album_image:document.querySelector("#form_album_image").value};await e.create(t)},deleteAlbum:async function(){let e=new handle.Album,t={album_idx:location.pathname.split("/")[3]},a=await e.delete(t);console.log(a)},loadAlbum:async function(e="all"){let t=new handle.Album,a=document.querySelector("#list_album"),l={album_idx:e};(await t.read(l)).result.forEach((e=>{let t=document.createElement("card-album"),l=document.createElement("card-album-title"),n=document.createElement("card-album-text");t.setAttribute("image-src",e.album_image),t.setAttribute("album-idx",e.idx),l.innerText=e.album_title,n.innerText=e.album_text,t.appendChild(l),t.appendChild(n),a.insertAdjacentElement("beforeend",t)}))},loadAlbumSelect:async function(){let e=new handle.Album,t=document.querySelector("#form_music_albums");(await e.read({album_idx:"all"})).result.forEach((e=>{let a=document.createElement("option");a.setAttribute("value",e.idx),a.innerText=e.album_title,t.insertAdjacentElement("beforeend",a)}))}};customElements.define("card-album",a),handle=t})();